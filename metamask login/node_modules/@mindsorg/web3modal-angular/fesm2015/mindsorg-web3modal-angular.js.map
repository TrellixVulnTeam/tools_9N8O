{"version":3,"file":"mindsorg-web3modal-angular.js","sources":["../../../projects/web3modal/src/lib/web3-modal/web3-modal.service.ts","../../../projects/web3modal/src/lib/web3-modal/web3-modal.component.ts","../../../projects/web3modal/src/lib/modal/modal.component.ts","../../../projects/web3modal/src/lib/web3-modal/web3-modal.module.ts","../../../projects/web3modal/src/public-api.ts","../../../projects/web3modal/src/mindsorg-web3modal-angular.ts"],"sourcesContent":["import { EventEmitter, Injectable, Optional } from '@angular/core';\nimport {\n  CONNECT_EVENT,\n  ERROR_EVENT,\n  IProviderControllerOptions,\n  Web3WalletConnector,\n  IProviderUserOptions\n} from '@mindsorg/web3modal-ts';\nimport { take } from 'rxjs/operators';\n\n@Injectable()\nexport class Web3ModalService {\n  private web3WalletConnector: Web3WalletConnector\n\n  public shouldOpen: EventEmitter<boolean> = new EventEmitter();\n  public providers: EventEmitter<IProviderUserOptions[]> = new EventEmitter();\n\n  constructor (@Optional() configOptions?: IProviderControllerOptions) {\n    this.web3WalletConnector = new Web3WalletConnector(configOptions)\n  }\n\n  async open() {\n    this.providers.next(this.web3WalletConnector.providers)\n\n    return await new Promise((resolve, reject) => {\n      this.web3WalletConnector.providerController.on(CONNECT_EVENT, provider => {\n        resolve(provider);\n      });\n  \n      this.web3WalletConnector.providerController.on(ERROR_EVENT, error => {\n        reject(error);\n      });\n\n      this.shouldOpen.next(true)\n\n      this.shouldOpen.pipe(take(1)).subscribe({\n        next: (open) => {\n          if (!open) {\n            reject('Dismissed modal');\n          }\n        }\n      })\n    }).finally(() => {\n      this.close()\n    })\n  }\n\n  setConfiguration(options: IProviderControllerOptions) {\n    this.web3WalletConnector.setConfiguration(options)\n  }\n\n  clearCachedProvider(): void {\n    this.web3WalletConnector.providerController.clearCachedProvider();\n  }\n\n  setCachedProvider(id: string): void {\n    this.web3WalletConnector.providerController.setCachedProvider(id);\n  }\n\n  close() {\n    this.shouldOpen.next(false)\n  }\n}\n","import {\n  Component,\n  Input,\n  OnDestroy,\n  OnInit,\n  ViewEncapsulation,\n} from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { IProviderUserOptions } from '@mindsorg/web3modal-ts';\nimport { Web3ModalService } from './web3-modal.service';\n\n@Component({\n  selector: 'm-web3-modal',\n  templateUrl: 'web3-modal.component.html',\n  styleUrls: ['./web3-modal.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class Web3ModalComponent implements OnInit, OnDestroy {\n  open = false;\n  providers: IProviderUserOptions[] = [];\n  showMetamaskDownload: boolean;\n\n  private openSubscription: Subscription;\n  private providersSubscription: Subscription;\n  private readonly metamaskShopURL = 'https://metamask.io/download.html';\n\n  @Input() title: string;\n  @Input() description?: string;\n  @Input() descriptionGray?: string;\n  @Input() dismissText?: string;\n  @Input() promptMetamaskIfNotInstalled = false;\n\n  constructor(private service: Web3ModalService) {}\n\n  ngOnInit(): void {\n    this.openSubscription = this.service.shouldOpen.subscribe({\n      next: (open: boolean) => {\n        this.open = open;\n      },\n    });\n\n    this.providersSubscription = this.service.providers.subscribe({\n      next: (providers: IProviderUserOptions[]) => {\n        this.showMetamaskDownload =\n          this.promptMetamaskIfNotInstalled &&\n          !this.isMetamaskInProviders(providers);\n        this.providers = providers;\n      },\n    });\n  }\n\n  ngOnDestroy(): void {\n    this.openSubscription.unsubscribe();\n    this.providersSubscription.unsubscribe();\n  }\n\n  close(): void {\n    this.service.close();\n  }\n\n  private isMetamaskInProviders(providers: IProviderUserOptions[]): boolean {\n    return providers.some((p) => p.name.toLowerCase() === 'metamask');\n  }\n\n  private openMetamaskDownloadPage(): void {\n    window.open(this.metamaskShopURL, '_blank');\n  }\n}\n","import { Component, EventEmitter, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'm-modal',\n  host: {\n    '[hidden]': 'hidden',\n  },\n  inputs: ['open', 'allowClose'],\n  outputs: ['closed'],\n  styleUrls: ['./modal.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  templateUrl: './modal.component.html',\n})\nexport class Modal {\n  allowClose: boolean = true;\n  hidden: boolean = true;\n  closed: EventEmitter<any> = new EventEmitter();\n\n  set _hidden(value: boolean) {\n    this.hidden = value;\n  }\n\n  set open(value: boolean) {\n    this.hidden = !value;\n  }\n\n  close(event) {\n    if (!this.allowClose) return;\n\n    this.hidden = !this.hidden;\n    this.closed.next(true);\n    event.stopPropagation();\n  }\n}\n","import { CommonModule as NgCommonModule } from '@angular/common';\nimport {\n  NgModule,\n} from '@angular/core';\nimport { Modal } from '../modal/modal.component';\nimport { Web3ModalComponent } from './web3-modal.component';\n\n@NgModule({\n  imports: [NgCommonModule],\n  declarations: [Modal, Web3ModalComponent],\n  exports: [Web3ModalComponent],\n})\nexport class Web3ModalModule { }","/*\n * Public API Surface of web3modal\n */\n\nexport * from './lib/web3-modal/web3-modal.service';\nexport * from './lib/web3-modal/web3-modal.component';\nexport * from './lib/web3-modal/web3-modal.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {Modal as Éµa} from './lib/modal/modal.component';"],"names":["NgCommonModule"],"mappings":"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"}